# 设计方案

## Boot (开启mmu前)

一些无法使用的语言特性，使用后程序会跑飞，需要使用括号内替代方式或禁止使用：
    
    1. &dyn Trait (vtable)
    2. &str == &str (&str.eq(&str))
    3. &[T;n] 作为 参数传递 ([T;n])

使用到的函数和static需要链接到`.text.boot`段，为简化代码，引入`#[link_boot]` 宏，将整个 `mod` 内所有函数和static链接到`.text.boot`段。

`_start` 入口计算加载地址和虚拟地址 `offset`，存为 `static`变量， `boot`页表将代码段映射到固定虚拟地址，其余区域直接映射到物理地址，快速开启`mmu`。

`mmu` 开启后，获取平台内存信息，重定位 `sp` 至物理内存末尾，为多 `cpu` 预留内存。

`sp` 重定位后，在代码段后部保存 `dtb` 等保留信息，并在物理内存中间创建临时页表，将 `sp` 映射到虚拟地址，以及其他区域虚拟地址的映射。

替换为新的临时页表，并重定向到`sp`虚拟地址和虚拟地址入口。


### 内存区域

| 占用空间                  | 描述                     |
| ------------------------ | ----------------------- |
| kernel_size              | 引导代码                 |
| 